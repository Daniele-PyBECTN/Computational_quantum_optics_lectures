<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>8&nbsp; Introduction to QuTiP – Numerical Methods for Quantum Optics and Open Quantum Systems</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../lecture1/closed_systems.html" rel="next">
<link href="../lecture1/quantum_objects_numpy.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-f428fda71a3abb5b1b9c21151da8fd61.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-6ec1ea2183979a90750e7180bf9040de.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-f428fda71a3abb5b1b9c21151da8fd61.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-a05c414534bf92e6e9143109a8b81349.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-9f1aa53ba50352805ba78653d73b174c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../site_libs/bootstrap/bootstrap-a05c414534bf92e6e9143109a8b81349.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Numerical Methods for Quantum Optics and Open Quantum Systems</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
    <a href="../Numerical-Methods-for-Quantum-Optics-and-Open-Quantum-Systems.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../lecture1/qutip_introduction.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Introduction to QuTiP</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Home Page</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lecture1/introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lecture1/linear_algebra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Linear Algebra with NumPy and SciPy</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lecture1/numba_and_jax.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Speeding up Python for Linear Algebra Tasks</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lecture1/ordinary_differential_equations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Ordinary Differential Equations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lecture1/phase_space_ode.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">From Hamilton’s equations to the Liouville equation in phase space</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lecture1/quantum_objects_numpy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Representing Quantum States and Operators with NumPy</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lecture1/qutip_introduction.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Introduction to QuTiP</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lecture1/closed_systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Closed Quantum Systems in QuTiP: The Schrödinger equation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lecture2/master_equation_qutip.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Open Dynamics in QuTiP: The Master Equation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lecture2/jaynes_cummings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">The Jaynes–Cummings model: The Prove of Field Quantization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lecture3/mollow_triplet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Resonance Fluorescence and the Mollow Triplet</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lecture3/jaynes_cummings_spectrum.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">The Emission Spectrum of the Jaynes–Cummings Model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bibliography.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bibliography</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/quantum-harmonic-oscillator.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">The quantum harmonic oscillator</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/wigner_function.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">From classical densities to the Wigner function</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#quantum-operators" id="toc-quantum-operators" class="nav-link active" data-scroll-target="#quantum-operators"><span class="header-section-number">8.1</span> Quantum Operators</a>
  <ul class="collapse">
  <li><a href="#creating-operators" id="toc-creating-operators" class="nav-link" data-scroll-target="#creating-operators"><span class="header-section-number">8.1.1</span> Creating Operators</a></li>
  <li><a href="#operator-functions-and-operations" id="toc-operator-functions-and-operations" class="nav-link" data-scroll-target="#operator-functions-and-operations"><span class="header-section-number">8.1.2</span> Operator Functions and Operations</a></li>
  </ul></li>
  <li><a href="#quantum-states" id="toc-quantum-states" class="nav-link" data-scroll-target="#quantum-states"><span class="header-section-number">8.2</span> Quantum States</a>
  <ul class="collapse">
  <li><a href="#fock-states" id="toc-fock-states" class="nav-link" data-scroll-target="#fock-states"><span class="header-section-number">8.2.1</span> Fock States</a></li>
  <li><a href="#superposition-states" id="toc-superposition-states" class="nav-link" data-scroll-target="#superposition-states"><span class="header-section-number">8.2.2</span> Superposition States</a></li>
  <li><a href="#coherent-states" id="toc-coherent-states" class="nav-link" data-scroll-target="#coherent-states"><span class="header-section-number">8.2.3</span> Coherent States</a></li>
  <li><a href="#spin-states" id="toc-spin-states" class="nav-link" data-scroll-target="#spin-states"><span class="header-section-number">8.2.4</span> Spin States</a></li>
  <li><a href="#density-matrices" id="toc-density-matrices" class="nav-link" data-scroll-target="#density-matrices"><span class="header-section-number">8.2.5</span> Density Matrices</a></li>
  <li><a href="#partial-trace" id="toc-partial-trace" class="nav-link" data-scroll-target="#partial-trace"><span class="header-section-number">8.2.6</span> Partial Trace</a></li>
  </ul></li>
  <li><a href="#eigenstates-and-eigenvalues" id="toc-eigenstates-and-eigenvalues" class="nav-link" data-scroll-target="#eigenstates-and-eigenvalues"><span class="header-section-number">8.3</span> Eigenstates and Eigenvalues</a></li>
  <li><a href="#computing-expectation-values" id="toc-computing-expectation-values" class="nav-link" data-scroll-target="#computing-expectation-values"><span class="header-section-number">8.4</span> Computing Expectation Values</a></li>
  <li><a href="#a-complete-example-the-quantum-harmonic-oscillator" id="toc-a-complete-example-the-quantum-harmonic-oscillator" class="nav-link" data-scroll-target="#a-complete-example-the-quantum-harmonic-oscillator"><span class="header-section-number">8.5</span> A complete example: the Quantum Harmonic Oscillator</a></li>
  <li><a href="#passing-in-the-position-basis" id="toc-passing-in-the-position-basis" class="nav-link" data-scroll-target="#passing-in-the-position-basis"><span class="header-section-number">8.6</span> Passing in the position basis</a></li>
  </ul>
<div class="quarto-other-links"><h2>Other Links</h2><ul><li><a href="https://mybinder.org/v2/gh/Daniele-PyBECTN/Computational_quantum_optics_lectures/notebooks/?urlpath=lab/tree/notebooks/lecture1/qutip_introduction.ipynb"><i class="bi bi-file-code"></i>Run notebook in Binder</a></li><li><a href="https://colab.research.google.com/github/Daniele-PyBECTN/Computational_quantum_optics_lectures/blob/notebooks/notebooks/lecture1/qutip_introduction.ipynb"><i class="bi bi-google"></i>Run notebook in Google Colab</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Introduction to QuTiP</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>The QuTiP package can be imported with</p>
<div class="quarto-embed-nb-cell" data-notebook="/home/runner/work/Computational_quantum_optics_lectures/Computational_quantum_optics_lectures/notebooks/lecture1/qutip_introduction.qmd" data-notebook-title="Introduction to QuTiP" data-notebook-cellid="cell-qutip-import">
<div id="qutip-import" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> qutip</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>It can also be imported with the command <code>from qutip import *</code>, that automatically imports all the QuTiP functions. However, here we use the first method, in order to explicitly see the QuTiP functions.</p>
<div class="quarto-embed-nb-cell" data-notebook="/home/runner/work/Computational_quantum_optics_lectures/Computational_quantum_optics_lectures/notebooks/lecture1/qutip_introduction.qmd" data-notebook-title="Introduction to QuTiP" data-notebook-cellid="cell-qutip-about">
<div id="qutip-about" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a>qutip.about()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
QuTiP: Quantum Toolbox in Python
================================
Copyright (c) QuTiP team 2011 and later.
Current admin team: Alexander Pitchford, Nathan Shammah, Shahnawaz Ahmed, Neill Lambert, Eric Giguère, Boxi Li, Simon Cross, Asier Galicia, Paul Menczel, and Patrick Hopf.
Board members: Daniel Burgarth, Robert Johansson, Anton F. Kockum, Franco Nori and Will Zeng.
Original developers: R. J. Johansson &amp; P. D. Nation.
Previous lead developers: Chris Granade &amp; A. Grimsmo.
Currently developed through wide collaboration. See https://github.com/qutip for details.

QuTiP Version:      5.1.1
Numpy Version:      2.2.6
Scipy Version:      1.15.3
Cython Version:     3.1.1
Matplotlib Version: 3.10.3
Python Version:     3.13.3
Number of CPUs:     4
BLAS Info:          Generic
INTEL MKL Ext:      None
Platform Info:      Linux (x86_64)
Installation path:  /opt/hostedtoolcache/Python/3.13.3/x64/lib/python3.13/site-packages/qutip

Installed QuTiP family packages
-------------------------------

No QuTiP family packages installed.

================================================================================
Please cite QuTiP in your publication.
================================================================================
For your convenience a bibtex reference can be easily generated using `qutip.cite()`</code></pre>
</div>
</div>
</div>
<section id="quantum-operators" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="quantum-operators"><span class="header-section-number">8.1</span> Quantum Operators</h2>
<p>Quantum operators play a crucial role in the formulation of quantum mechanics, representing physical observables and operations on quantum states. In QuTiP, operators are represented as <code>Qobj</code> instances, just like quantum states. This section introduces the creation and manipulation of quantum operators.</p>
<section id="creating-operators" class="level3" data-number="8.1.1">
<h3 data-number="8.1.1" class="anchored" data-anchor-id="creating-operators"><span class="header-section-number">8.1.1</span> Creating Operators</h3>
<p>Operators in quantum mechanics can represent measurements, such as position or momentum, and transformations, such as rotation. Let’s see how we can define some common operators in QuTiP.</p>
<section id="the-annihilation-operator-of-the-quantum-harmonic-oscillator" class="level4">
<h4 class="anchored" data-anchor-id="the-annihilation-operator-of-the-quantum-harmonic-oscillator">The Annihilation Operator of the Quantum Harmonic oscillator</h4>
<p>The harmonic oscillator is a fundamental model in quantum mechanics for understanding various physical systems. Its quantization leads to the concept of creation and annihilation operators, which respectively increase and decrease the energy of the system by one quantum of energy.</p>
<p>The annihilation operator, often denoted by <span class="math inline">\(\hat{a}\)</span>, acts on a quantum state to reduce its quantum number. The action of <span class="math inline">\(\hat{a}\)</span> on a state <span class="math inline">\(|n\rangle\)</span> is defined as:</p>
<p><span class="math display">\[
\hat{a} |n\rangle = \sqrt{n} |n-1\rangle
\]</span></p>
<p>Here, <span class="math inline">\(|n\rangle\)</span> represents a quantum state with <span class="math inline">\(n\)</span> quanta of energy (also known as a Fock state), and <span class="math inline">\(\sqrt{n}\)</span> is the normalization factor. The matrix representation of the annihilation operator in an <span class="math inline">\(d\)</span>-dimensional Hilbert space is given by an upper triangular matrix with the square roots of natural numbers as its off-diagonal elements.</p>
<div class="quarto-embed-nb-cell" data-notebook="/home/runner/work/Computational_quantum_optics_lectures/Computational_quantum_optics_lectures/notebooks/lecture1/qutip_introduction.qmd" data-notebook-title="Introduction to QuTiP" data-notebook-cellid="cell-annihilation-operator">
<div id="cell-annihilation-operator" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># Define the annihilation operator for d-dimensional Hilbert space</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>d <span class="op">=</span> <span class="dv">7</span></span>
<span id="cb4-3"><a href="#cb4-3"></a></span>
<span id="cb4-4"><a href="#cb4-4"></a>a <span class="op">=</span> qutip.destroy(d)</span>
<span id="cb4-5"><a href="#cb4-5"></a></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="bu">print</span>(<span class="st">"Annihilation operator (a) for d=7:"</span>)</span>
<span id="cb4-7"><a href="#cb4-7"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Annihilation operator (a) for d=7:</code></pre>
</div>
<div id="annihilation-operator" class="cell-output cell-output-display">
<pre><code>Quantum object: dims=[[7], [7]], shape=(7, 7), type='oper', dtype=Dia, isherm=False
Qobj data =
[[0.         1.         0.         0.         0.         0.
  0.        ]
 [0.         0.         1.41421356 0.         0.         0.
  0.        ]
 [0.         0.         0.         1.73205081 0.         0.
  0.        ]
 [0.         0.         0.         0.         2.         0.
  0.        ]
 [0.         0.         0.         0.         0.         2.23606798
  0.        ]
 [0.         0.         0.         0.         0.         0.
  2.44948974]
 [0.         0.         0.         0.         0.         0.
  0.        ]]</code></pre>
</div>
</div>
</div>
</section>
<section id="pauli-matrices" class="level4">
<h4 class="anchored" data-anchor-id="pauli-matrices">Pauli Matrices</h4>
<p>The Pauli matrices are fundamental in the study of quantum mechanics, representing the spin operators for a spin-1/2 particle and quantum two-level systems.</p>
<p><span class="math display">\[
\sigma_x = \begin{pmatrix} 0 &amp; 1 \\ 1 &amp; 0 \end{pmatrix}, \ \sigma_y = \begin{pmatrix} 0 &amp; -i \\ i &amp; 0 \end{pmatrix}, \ \sigma_z = \begin{pmatrix} 1 &amp; 0 \\ 0 &amp; -1 \end{pmatrix}
\]</span></p>
<p>We can define these matrices in QuTiP as follows:</p>
<div class="quarto-embed-nb-cell" data-notebook="/home/runner/work/Computational_quantum_optics_lectures/Computational_quantum_optics_lectures/notebooks/lecture1/qutip_introduction.qmd" data-notebook-title="Introduction to QuTiP" data-notebook-cellid="cell-pauli-matrices">
<div id="pauli-matrices" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a>sigma_x <span class="op">=</span> qutip.sigmax()</span>
<span id="cb7-2"><a href="#cb7-2"></a>sigma_y <span class="op">=</span> qutip.sigmay()</span>
<span id="cb7-3"><a href="#cb7-3"></a>sigma_z <span class="op">=</span> qutip.sigmaz()</span>
<span id="cb7-4"><a href="#cb7-4"></a></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="bu">print</span>(<span class="st">"Sigma X:"</span>)</span>
<span id="cb7-6"><a href="#cb7-6"></a>display(sigma_x)</span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="bu">print</span>(<span class="st">"Sigma Y:"</span>)</span>
<span id="cb7-9"><a href="#cb7-9"></a>display(sigma_y)</span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="bu">print</span>(<span class="st">"Sigma Z:"</span>)</span>
<span id="cb7-12"><a href="#cb7-12"></a>sigma_z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sigma X:</code></pre>
</div>
<div id="pauli-matrices-1" class="cell-output cell-output-display">
<pre><code>Quantum object: dims=[[2], [2]], shape=(2, 2), type='oper', dtype=CSR, isherm=True
Qobj data =
[[0. 1.]
 [1. 0.]]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>

Sigma Y:</code></pre>
</div>
<div id="pauli-matrices-2" class="cell-output cell-output-display">
<pre><code>Quantum object: dims=[[2], [2]], shape=(2, 2), type='oper', dtype=CSR, isherm=True
Qobj data =
[[0.+0.j 0.-1.j]
 [0.+1.j 0.+0.j]]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>

Sigma Z:</code></pre>
</div>
<div id="pauli-matrices-3" class="cell-output cell-output-display">
<pre><code>Quantum object: dims=[[2], [2]], shape=(2, 2), type='oper', dtype=CSR, isherm=True
Qobj data =
[[ 1.  0.]
 [ 0. -1.]]</code></pre>
</div>
</div>
</div>
</section>
</section>
<section id="operator-functions-and-operations" class="level3" data-number="8.1.2">
<h3 data-number="8.1.2" class="anchored" data-anchor-id="operator-functions-and-operations"><span class="header-section-number">8.1.2</span> Operator Functions and Operations</h3>
<p>QuTiP supports various operations on operators, including addition, multiplication (both scalar and matrix), and the commutator. These operations are essential for constructing Hamiltonians, calculating observables, and more.</p>
<section id="example-commutator-of-pauli-matrices" class="level4">
<h4 class="anchored" data-anchor-id="example-commutator-of-pauli-matrices">Example: Commutator of Pauli Matrices</h4>
<p>The commutator of two operators <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> is defined as <span class="math inline">\([A, B] = AB - BA\)</span>. Let’s calculate the commutator of <span class="math inline">\(\sigma_x\)</span> and <span class="math inline">\(\sigma_y\)</span>.</p>
<div class="quarto-embed-nb-cell" data-notebook="/home/runner/work/Computational_quantum_optics_lectures/Computational_quantum_optics_lectures/notebooks/lecture1/qutip_introduction.qmd" data-notebook-title="Introduction to QuTiP" data-notebook-cellid="cell-commutator-example">
<div id="commutator-example" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a>commutator_xy <span class="op">=</span> qutip.commutator(sigma_x, sigma_y)</span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="bu">print</span>(<span class="st">"Commutator of Sigma X and Sigma Y:"</span>)</span>
<span id="cb14-3"><a href="#cb14-3"></a>display(commutator_xy)</span>
<span id="cb14-4"><a href="#cb14-4"></a>commutator_xy <span class="op">==</span> <span class="ot">2j</span> <span class="op">*</span> sigma_z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Commutator of Sigma X and Sigma Y:</code></pre>
</div>
<div id="commutator-example-1" class="cell-output cell-output-display">
<pre><code>Quantum object: dims=[[2], [2]], shape=(2, 2), type='oper', dtype=CSR, isherm=False
Qobj data =
[[0.+2.j 0.+0.j]
 [0.+0.j 0.-2.j]]</code></pre>
</div>
<div id="commutator-example-2" class="cell-output cell-output-display">
<pre><code>True</code></pre>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="quantum-states" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="quantum-states"><span class="header-section-number">8.2</span> Quantum States</h2>
<p>Quantum states describe the state of a quantum system. In QuTiP, states are represented again as <code>Qobj</code> instances. This section focuses on the representation and manipulation of quantum states.</p>
<section id="fock-states" class="level3" data-number="8.2.1">
<h3 data-number="8.2.1" class="anchored" data-anchor-id="fock-states"><span class="header-section-number">8.2.1</span> Fock States</h3>
<p>The most basic quantum states are the fock states, often denoted as <span class="math inline">\(|n\rangle\)</span> (with <span class="math inline">\(n \in \mathbb{N}\)</span>). Let’s see how we can create these in QuTiP.</p>
</section>
<section id="superposition-states" class="level3" data-number="8.2.2">
<h3 data-number="8.2.2" class="anchored" data-anchor-id="superposition-states"><span class="header-section-number">8.2.2</span> Superposition States</h3>
<p>Quantum mechanics allows particles to be in a superposition of states. Let’s create a superposition state.</p>
<p><span class="math display">\[
\vert \psi \rangle = \frac{1}{\sqrt{2}} \left( \vert 0 \rangle + \vert 1 \rangle \right)
\]</span></p>
<div class="quarto-embed-nb-cell" data-notebook="/home/runner/work/Computational_quantum_optics_lectures/Computational_quantum_optics_lectures/notebooks/lecture1/qutip_introduction.qmd" data-notebook-title="Introduction to QuTiP" data-notebook-cellid="cell-superposition-state">
<div id="cell-superposition-state" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1"></a>fock_0 <span class="op">=</span> qutip.fock(d, <span class="dv">0</span>)  <span class="co"># Fock state |0&gt;</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>fock_1 <span class="op">=</span> qutip.fock(d, <span class="dv">1</span>)  <span class="co"># Fock state |1&gt;</span></span>
<span id="cb18-3"><a href="#cb18-3"></a></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="co"># Creating a superposition state</span></span>
<span id="cb18-5"><a href="#cb18-5"></a>superposition_state <span class="op">=</span> (fock_0 <span class="op">+</span> fock_1).unit()  <span class="co"># Normalize the state</span></span>
<span id="cb18-6"><a href="#cb18-6"></a></span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="bu">print</span>(<span class="st">"Superposition state:"</span>)</span>
<span id="cb18-8"><a href="#cb18-8"></a>superposition_state</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Superposition state:</code></pre>
</div>
<div id="superposition-state" class="cell-output cell-output-display">
<pre><code>Quantum object: dims=[[7], [1]], shape=(7, 1), type='ket', dtype=Dense
Qobj data =
[[0.70710678]
 [0.70710678]
 [0.        ]
 [0.        ]
 [0.        ]
 [0.        ]
 [0.        ]]</code></pre>
</div>
</div>
</div>
</section>
<section id="coherent-states" class="level3" data-number="8.2.3">
<h3 data-number="8.2.3" class="anchored" data-anchor-id="coherent-states"><span class="header-section-number">8.2.3</span> Coherent States</h3>
<p>Coherent states in QuTiP represent quantum states closest to classical waves, defined as <span class="math display">\[
|\alpha\rangle = e^{-|\alpha|^2/2} \sum_{n=0}^{\infty} \frac{\alpha^n}{\sqrt{n!}} |n\rangle \, ,
\]</span></p>
<p>with minimal uncertainty.</p>
<p>The coherent state is an eigenstate of the annihilation operator <span class="math display">\[
\hat{a} \vert \alpha \rangle = \alpha \vert \alpha \rangle
\]</span></p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning!
</div>
</div>
<div class="callout-body-container callout-body">
<p>Remember that every <code>Qobj</code> lives in a truncated Hilbert space. If the <span class="math inline">\(\alpha\)</span> value is too large, the state will become a non-physical state because it will touch the high energy levels of the truncated Hilbert space.</p>
</div>
</div>
<div class="quarto-embed-nb-cell" data-notebook="/home/runner/work/Computational_quantum_optics_lectures/Computational_quantum_optics_lectures/notebooks/lecture1/qutip_introduction.qmd" data-notebook-title="Introduction to QuTiP" data-notebook-cellid="cell-coherent-state">
<div id="cell-coherent-state" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1"></a>alpha <span class="op">=</span> <span class="fl">0.8</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>coherent_state <span class="op">=</span> qutip.coherent(d, alpha)</span>
<span id="cb21-3"><a href="#cb21-3"></a></span>
<span id="cb21-4"><a href="#cb21-4"></a>coherent_state</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="coherent-state" class="cell-output cell-output-display">
<pre><code>Quantum object: dims=[[7], [1]], shape=(7, 1), type='ket', dtype=Dense
Qobj data =
[[0.72614904]
 [0.58091919]
 [0.32861796]
 [0.1517784 ]
 [0.06073653]
 [0.02159193]
 [0.00767346]]</code></pre>
</div>
</div>
</div>
<p>Let’s compute the fidelity between <span class="math inline">\(\vert \alpha \rangle\)</span> and <span class="math inline">\(\hat{a} \vert \alpha \rangle / \alpha\)</span>.</p>
<div class="quarto-embed-nb-cell" data-notebook="/home/runner/work/Computational_quantum_optics_lectures/Computational_quantum_optics_lectures/notebooks/lecture1/qutip_introduction.qmd" data-notebook-title="Introduction to QuTiP" data-notebook-cellid="cell-coherent-state-fidelity">
<div id="cell-coherent-state-fidelity" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1"></a>qutip.fidelity(a <span class="op">*</span> coherent_state <span class="op">/</span> alpha, coherent_state)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="coherent-state-fidelity" class="cell-output cell-output-display">
<pre><code>np.float64(0.9999661194274998)</code></pre>
</div>
</div>
</div>
</section>
<section id="spin-states" class="level3" data-number="8.2.4">
<h3 data-number="8.2.4" class="anchored" data-anchor-id="spin-states"><span class="header-section-number">8.2.4</span> Spin States</h3>
<div class="quarto-embed-nb-cell" data-notebook="/home/runner/work/Computational_quantum_optics_lectures/Computational_quantum_optics_lectures/notebooks/lecture1/qutip_introduction.qmd" data-notebook-title="Introduction to QuTiP" data-notebook-cellid="cell-spin-state">
<div id="cell-spin-state" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1"></a>qutip.spin_state(<span class="fl">0.5</span>, <span class="op">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="spin-state" class="cell-output cell-output-display">
<pre><code>Quantum object: dims=[[2], [1]], shape=(2, 1), type='ket', dtype=Dense
Qobj data =
[[0.]
 [1.]]</code></pre>
</div>
</div>
</div>
</section>
<section id="density-matrices" class="level3" data-number="8.2.5">
<h3 data-number="8.2.5" class="anchored" data-anchor-id="density-matrices"><span class="header-section-number">8.2.5</span> Density Matrices</h3>
<p>Quantum states can also be represented using density matrices, which are useful for describing mixed states.</p>
<section id="creating-a-density-matrix" class="level4">
<h4 class="anchored" data-anchor-id="creating-a-density-matrix">Creating a Density Matrix</h4>
<p>Let’s convert our superposition state into a density matrix.</p>
<div class="quarto-embed-nb-cell" data-notebook="/home/runner/work/Computational_quantum_optics_lectures/Computational_quantum_optics_lectures/notebooks/lecture1/qutip_introduction.qmd" data-notebook-title="Introduction to QuTiP" data-notebook-cellid="cell-density-matrix">
<div id="cell-density-matrix" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1"></a><span class="co"># Creating a density matrix from a state</span></span>
<span id="cb27-2"><a href="#cb27-2"></a>density_matrix <span class="op">=</span> superposition_state <span class="op">*</span> superposition_state.dag()  <span class="co"># Outer product</span></span>
<span id="cb27-3"><a href="#cb27-3"></a></span>
<span id="cb27-4"><a href="#cb27-4"></a><span class="bu">print</span>(<span class="st">"Density matrix of the superposition state:"</span>)</span>
<span id="cb27-5"><a href="#cb27-5"></a>density_matrix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Density matrix of the superposition state:</code></pre>
</div>
<div id="density-matrix" class="cell-output cell-output-display">
<pre><code>Quantum object: dims=[[7], [7]], shape=(7, 7), type='oper', dtype=Dense, isherm=True
Qobj data =
[[0.5 0.5 0.  0.  0.  0.  0. ]
 [0.5 0.5 0.  0.  0.  0.  0. ]
 [0.  0.  0.  0.  0.  0.  0. ]
 [0.  0.  0.  0.  0.  0.  0. ]
 [0.  0.  0.  0.  0.  0.  0. ]
 [0.  0.  0.  0.  0.  0.  0. ]
 [0.  0.  0.  0.  0.  0.  0. ]]</code></pre>
</div>
</div>
</div>
</section>
</section>
<section id="partial-trace" class="level3" data-number="8.2.6">
<h3 data-number="8.2.6" class="anchored" data-anchor-id="partial-trace"><span class="header-section-number">8.2.6</span> Partial Trace</h3>
<p>The <strong>partial trace</strong> over a subsystem, say <span class="math inline">\(B\)</span>, of a composite system <span class="math inline">\(AB\)</span>, mathematically expresses as “tracing out” <span class="math inline">\(B\)</span>, leaving the reduced state of <span class="math inline">\(A\)</span>. For a bipartite state <span class="math inline">\(\rho_{AB}\)</span>, the partial trace over <span class="math inline">\(B\)</span> is:</p>
<p><span class="math display">\[
\text{Tr}_B(\hat{\rho}_{AB}) = \sum_{i \in \mathcal{H}_B} \langle i| \hat{\rho}_{AB} |i\rangle
\]</span></p>
<p>where <span class="math inline">\(\{|i\rangle\}\)</span> forms a complete basis for subsystem <span class="math inline">\(B\)</span>.</p>
<p>Let’s try it with an entangled Bell’s state between two qubits:</p>
<p><span class="math display">\[
\vert \phi^+ \rangle = \frac{1}{\sqrt{2}} \left( \vert 0, 0 \rangle + \vert 1, 1 \rangle \right)
\]</span></p>
<div class="quarto-embed-nb-cell" data-notebook="/home/runner/work/Computational_quantum_optics_lectures/Computational_quantum_optics_lectures/notebooks/lecture1/qutip_introduction.qmd" data-notebook-title="Introduction to QuTiP" data-notebook-cellid="cell-ptrace">
<div id="cell-ptrace" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1"></a><span class="co"># Bell state between two qubits</span></span>
<span id="cb30-2"><a href="#cb30-2"></a>phi_plus <span class="op">=</span> ( qutip.tensor(qutip.spin_state(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="op">-</span><span class="dv">1</span>), qutip.spin_state(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="op">-</span><span class="dv">1</span>)) <span class="op">+</span> qutip.tensor(qutip.spin_state(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dv">1</span>), qutip.spin_state(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dv">1</span>)) ).unit()</span>
<span id="cb30-3"><a href="#cb30-3"></a></span>
<span id="cb30-4"><a href="#cb30-4"></a><span class="co"># Reduced density matrix of the first qubit</span></span>
<span id="cb30-5"><a href="#cb30-5"></a>rho_1 <span class="op">=</span> qutip.ptrace(phi_plus, <span class="dv">1</span>)</span>
<span id="cb30-6"><a href="#cb30-6"></a>rho_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="ptrace" class="cell-output cell-output-display">
<pre><code>Quantum object: dims=[[2], [2]], shape=(2, 2), type='oper', dtype=Dense, isherm=True
Qobj data =
[[0.5 0. ]
 [0.  0.5]]</code></pre>
</div>
</div>
</div>
<p>We now apply the partial trace to a more complicated state, that is composed by two bosonic modes and two spins <span class="math inline">\(\vert j_1, m_1 \rangle\)</span> and <span class="math inline">\(\vert j_2, m_2 \rangle\)</span>, with <span class="math inline">\(j_1 = 1\)</span> and <span class="math inline">\(j_2 = \frac{1}{2}\)</span>, <span class="math inline">\(m_1 = 0\)</span>, and <span class="math inline">\(m_2 = 1\)</span>.</p>
<div class="quarto-embed-nb-cell" data-notebook="/home/runner/work/Computational_quantum_optics_lectures/Computational_quantum_optics_lectures/notebooks/lecture1/qutip_introduction.qmd" data-notebook-title="Introduction to QuTiP" data-notebook-cellid="cell-ptrace-complex-state">
<div id="ptrace-complex-state" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1"></a>j1 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb32-2"><a href="#cb32-2"></a>j2 <span class="op">=</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span></span>
<span id="cb32-3"><a href="#cb32-3"></a>m1 <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb32-4"><a href="#cb32-4"></a>m2 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb32-5"><a href="#cb32-5"></a></span>
<span id="cb32-6"><a href="#cb32-6"></a></span>
<span id="cb32-7"><a href="#cb32-7"></a>psi <span class="op">=</span> qutip.tensor(qutip.fock(d, <span class="dv">3</span>), qutip.fock(d, <span class="dv">1</span>), qutip.spin_state(j1, <span class="dv">0</span>), qutip.spin_state(j2, <span class="dv">1</span>))</span>
<span id="cb32-8"><a href="#cb32-8"></a></span>
<span id="cb32-9"><a href="#cb32-9"></a><span class="co"># Trace only the second spin state</span></span>
<span id="cb32-10"><a href="#cb32-10"></a>rho_0 <span class="op">=</span> qutip.ptrace(psi, [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb32-11"><a href="#cb32-11"></a>display(rho_0)</span>
<span id="cb32-12"><a href="#cb32-12"></a></span>
<span id="cb32-13"><a href="#cb32-13"></a><span class="co"># Trace only the first bosonic mode and the second spin state</span></span>
<span id="cb32-14"><a href="#cb32-14"></a>rho_1 <span class="op">=</span> qutip.ptrace(psi, [<span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb32-15"><a href="#cb32-15"></a>display(rho_1)</span>
<span id="cb32-16"><a href="#cb32-16"></a></span>
<span id="cb32-17"><a href="#cb32-17"></a><span class="co"># Trace all except the second bosonic mode</span></span>
<span id="cb32-18"><a href="#cb32-18"></a>rho_2 <span class="op">=</span> qutip.ptrace(psi, [<span class="dv">1</span>])</span>
<span id="cb32-19"><a href="#cb32-19"></a>rho_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="ptrace-complex-state-1" class="cell-output cell-output-display">
<pre><code>Quantum object: dims=[[7, 7, 3], [7, 7, 3]], shape=(147, 147), type='oper', dtype=Dense, isherm=True
Qobj data =
[[0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 ...
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]]</code></pre>
</div>
<div id="ptrace-complex-state-2" class="cell-output cell-output-display">
<pre><code>Quantum object: dims=[[7, 3], [7, 3]], shape=(21, 21), type='oper', dtype=Dense, isherm=True
Qobj data =
[[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]</code></pre>
</div>
<div id="ptrace-complex-state-3" class="cell-output cell-output-display">
<pre><code>Quantum object: dims=[[7], [7]], shape=(7, 7), type='oper', dtype=Dense, isherm=True
Qobj data =
[[0. 0. 0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0.]]</code></pre>
</div>
</div>
</div>
</section>
</section>
<section id="eigenstates-and-eigenvalues" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="eigenstates-and-eigenvalues"><span class="header-section-number">8.3</span> Eigenstates and Eigenvalues</h2>
<p>The eigenstates and eigenvalues of a system or an operator provide crucial insights into its properties. Let’s explore how to calculate these in QuTiP.</p>
<div class="quarto-embed-nb-cell" data-notebook="/home/runner/work/Computational_quantum_optics_lectures/Computational_quantum_optics_lectures/notebooks/lecture1/qutip_introduction.qmd" data-notebook-title="Introduction to QuTiP" data-notebook-cellid="cell-eigenstates-eigenvalues">
<div id="eigenstates-eigenvalues" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1"></a><span class="co"># Example: Eigenstates and eigenvalues of Pauli Z</span></span>
<span id="cb36-2"><a href="#cb36-2"></a>eigenvalues, eigenstates <span class="op">=</span> sigma_z.eigenstates()</span>
<span id="cb36-3"><a href="#cb36-3"></a></span>
<span id="cb36-4"><a href="#cb36-4"></a><span class="bu">print</span>(<span class="st">"Eigenvalues of Sigma Z:"</span>)</span>
<span id="cb36-5"><a href="#cb36-5"></a>display(eigenvalues)</span>
<span id="cb36-6"><a href="#cb36-6"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb36-7"><a href="#cb36-7"></a><span class="bu">print</span>(<span class="st">"Eigenstates of Sigma Z:"</span>)</span>
<span id="cb36-8"><a href="#cb36-8"></a>display(eigenstates)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Eigenvalues of Sigma Z:</code></pre>
</div>
<div id="eigenstates-eigenvalues-1" class="cell-output cell-output-display">
<pre><code>array([-1.,  1.])</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>

Eigenstates of Sigma Z:</code></pre>
</div>
<div id="eigenstates-eigenvalues-2" class="cell-output cell-output-display">
<pre><code>array([Quantum object: dims=[[2], [1]], shape=(2, 1), type='ket', dtype=Dense
       Qobj data =
       [[ 0.]
        [-1.]]                                                               ,
       Quantum object: dims=[[2], [1]], shape=(2, 1), type='ket', dtype=Dense
       Qobj data =
       [[-1.]
        [-0.]]                                                               ],
      dtype=object)</code></pre>
</div>
</div>
</div>
</section>
<section id="computing-expectation-values" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="computing-expectation-values"><span class="header-section-number">8.4</span> Computing Expectation Values</h2>
<p>The expectation value of an operator provides insight into the average outcome of a quantum measurement. For a quantum state <span class="math inline">\(|\psi\rangle\)</span> and an operator <span class="math inline">\(\hat{O}\)</span>, the expectation value is given by:</p>
<p><span class="math display">\[
\langle \hat{O} \rangle = \langle\psi| \hat{O} |\psi\rangle
\]</span></p>
<p>Expectation values are crucial for predicting measurable quantities in quantum mechanics. Let’s compute the expectation value of the number operator <span class="math inline">\(\hat{n} = \hat{a}^\dagger \hat{a}\)</span> for a coherent state, which represents a quantum state closest to a classical harmonic oscillator.</p>
<div class="quarto-embed-nb-cell" data-notebook="/home/runner/work/Computational_quantum_optics_lectures/Computational_quantum_optics_lectures/notebooks/lecture1/qutip_introduction.qmd" data-notebook-title="Introduction to QuTiP" data-notebook-cellid="cell-expectation-value">
<div id="expectation-value" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1"></a><span class="co"># Define the coherent state |psi&gt; with alpha=2</span></span>
<span id="cb41-2"><a href="#cb41-2"></a>alpha <span class="op">=</span> <span class="fl">0.8</span></span>
<span id="cb41-3"><a href="#cb41-3"></a>psi <span class="op">=</span> qutip.coherent(d, alpha)</span>
<span id="cb41-4"><a href="#cb41-4"></a></span>
<span id="cb41-5"><a href="#cb41-5"></a><span class="co"># Define the number operator n = a.dag() * a</span></span>
<span id="cb41-6"><a href="#cb41-6"></a>n <span class="op">=</span> a.dag() <span class="op">*</span> a</span>
<span id="cb41-7"><a href="#cb41-7"></a></span>
<span id="cb41-8"><a href="#cb41-8"></a><span class="co"># Compute the expectation value of n for the state |psi&gt;</span></span>
<span id="cb41-9"><a href="#cb41-9"></a>expectation_value_n <span class="op">=</span> qutip.expect(n, psi)</span>
<span id="cb41-10"><a href="#cb41-10"></a></span>
<span id="cb41-11"><a href="#cb41-11"></a><span class="bu">print</span>(<span class="st">"Expectation value of the number operator for |psi&gt;:"</span>)</span>
<span id="cb41-12"><a href="#cb41-12"></a>display(expectation_value_n)</span>
<span id="cb41-13"><a href="#cb41-13"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb41-14"><a href="#cb41-14"></a><span class="bu">print</span>(<span class="st">"The squared modulus of alpha is:"</span>)</span>
<span id="cb41-15"><a href="#cb41-15"></a>display(<span class="bu">abs</span>(alpha) <span class="op">**</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Expectation value of the number operator for |psi&gt;:</code></pre>
</div>
<div id="expectation-value-1" class="cell-output cell-output-display">
<pre><code>0.639996733025295</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>

The squared modulus of alpha is:</code></pre>
</div>
<div id="expectation-value-2" class="cell-output cell-output-display">
<pre><code>0.6400000000000001</code></pre>
</div>
</div>
</div>
</section>
<section id="a-complete-example-the-quantum-harmonic-oscillator" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="a-complete-example-the-quantum-harmonic-oscillator"><span class="header-section-number">8.5</span> A complete example: the Quantum Harmonic Oscillator</h2>
<p>In <a href="../appendices/quantum-harmonic-oscillator.html" class="quarto-xref"><span>Appendix A</span></a> we have already defined the quantum harmonic oscillator, which is a fundamental model in quantum mechanics. In the energy eigenbasis, the quantum harmonic oscillator is described by the Hamiltonian</p>
<p><span class="math display">\[
\hat{H} = \omega \hat{a}^\dagger \hat{a} \, ,
\]</span></p>
<p>where <span class="math inline">\(\omega\)</span> is the resonance frequency and <span class="math inline">\(\hat{a}\)</span> is the bosonic annihilation operator. In this basis, the Hamiltonian is indeed diagonal, with eigenvalues <span class="math inline">\(E_n = \omega n\)</span>, where <span class="math inline">\(n \in \mathbb{N}\)</span>.</p>
<div class="quarto-embed-nb-cell" data-notebook="/home/runner/work/Computational_quantum_optics_lectures/Computational_quantum_optics_lectures/notebooks/lecture1/qutip_introduction.qmd" data-notebook-title="Introduction to QuTiP" data-notebook-cellid="cell-hamiltonian">
<div id="cell-hamiltonian" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1"></a>N <span class="op">=</span> <span class="dv">120</span> <span class="co"># Hilbert space cutoff</span></span>
<span id="cb46-2"><a href="#cb46-2"></a>w <span class="op">=</span> <span class="dv">1</span> <span class="co"># Resonance frequency of the harmonic oscillator</span></span>
<span id="cb46-3"><a href="#cb46-3"></a></span>
<span id="cb46-4"><a href="#cb46-4"></a>a <span class="op">=</span> qutip.destroy(N)</span>
<span id="cb46-5"><a href="#cb46-5"></a></span>
<span id="cb46-6"><a href="#cb46-6"></a>H <span class="op">=</span> w <span class="op">*</span> a.dag() <span class="op">*</span> a</span>
<span id="cb46-7"><a href="#cb46-7"></a></span>
<span id="cb46-8"><a href="#cb46-8"></a>H</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="hamiltonian" class="cell-output cell-output-display">
<pre><code>Quantum object: dims=[[120], [120]], shape=(120, 120), type='oper', dtype=Dia, isherm=True
Qobj data =
[[  0.   0.   0. ...   0.   0.   0.]
 [  0.   1.   0. ...   0.   0.   0.]
 [  0.   0.   2. ...   0.   0.   0.]
 ...
 [  0.   0.   0. ... 117.   0.   0.]
 [  0.   0.   0. ...   0. 118.   0.]
 [  0.   0.   0. ...   0.   0. 119.]]</code></pre>
</div>
</div>
</div>
</section>
<section id="passing-in-the-position-basis" class="level2" data-number="8.6">
<h2 data-number="8.6" class="anchored" data-anchor-id="passing-in-the-position-basis"><span class="header-section-number">8.6</span> Passing in the position basis</h2>
<p>From the classical point of view, we are used to describe the harmonic oscillator in terms of position and momentum. In quantum mechanics, we can also express the system in terms of the position and momentum operators, which are related to the annihilation and creation operators as follows (<span class="math inline">\(\hbar = 1\)</span>):</p>
<p><span class="math display">\[\begin{align*}
\hat{x} &amp;= \frac{1}{\sqrt{2 m \omega}} \left( \hat{a} + \hat{a}^\dagger \right) \, , \\
\hat{p} &amp;= i \sqrt{\frac{m \omega}{2}} \left( \hat{a}^\dagger - \hat{a} \right) \, .
\end{align*}\]</span></p>
<p>We first check that</p>
<p><span class="math display">\[
\left[ \hat{x}, \hat{p} \right] = i
\]</span></p>
<div class="quarto-embed-nb-cell" data-notebook="/home/runner/work/Computational_quantum_optics_lectures/Computational_quantum_optics_lectures/notebooks/lecture1/qutip_introduction.qmd" data-notebook-title="Introduction to QuTiP" data-notebook-cellid="cell-commutator-check">
<div id="cell-commutator-check" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1"></a>m <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb48-2"><a href="#cb48-2"></a></span>
<span id="cb48-3"><a href="#cb48-3"></a>x <span class="op">=</span> (a <span class="op">+</span> a.dag()) <span class="op">/</span> np.sqrt(<span class="dv">2</span> <span class="op">*</span> m <span class="op">*</span> w)</span>
<span id="cb48-4"><a href="#cb48-4"></a>p <span class="op">=</span> <span class="op">-</span> <span class="ot">1j</span> <span class="op">*</span> (a <span class="op">-</span> a.dag()) <span class="op">*</span> np.sqrt(m <span class="op">*</span> w <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb48-5"><a href="#cb48-5"></a></span>
<span id="cb48-6"><a href="#cb48-6"></a>qutip.commutator(x, p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="commutator-check" class="cell-output cell-output-display">
<pre><code>Quantum object: dims=[[120], [120]], shape=(120, 120), type='oper', dtype=Dia, isherm=False
Qobj data =
[[0.  +1.j 0.  +0.j 0.  +0.j ... 0.  +0.j 0.  +0.j 0.  +0.j]
 [0.  +0.j 0.  +1.j 0.  +0.j ... 0.  +0.j 0.  +0.j 0.  +0.j]
 [0.  +0.j 0.  +0.j 0.  +1.j ... 0.  +0.j 0.  +0.j 0.  +0.j]
 ...
 [0.  +0.j 0.  +0.j 0.  +0.j ... 0.  +1.j 0.  +0.j 0.  +0.j]
 [0.  +0.j 0.  +0.j 0.  +0.j ... 0.  +0.j 0.  +1.j 0.  +0.j]
 [0.  +0.j 0.  +0.j 0.  +0.j ... 0.  +0.j 0.  +0.j 0.-119.j]]</code></pre>
</div>
</div>
</div>
<p>We now numerically diagonalize the position operator <span class="math inline">\(\hat{x}\)</span>, such that <span class="math inline">\(\hat{U}^\dagger \hat{x} \hat{U}\)</span> is diagonal. Then we plot the eigenstates of the quantum harmonic oscillator in the new basis, obtained with</p>
<p><span class="math display">\[
\vert \phi_n (x) \rangle = \hat{U}^\dagger \vert \psi_n \rangle
\]</span></p>
<div class="quarto-embed-nb-cell" data-notebook="/home/runner/work/Computational_quantum_optics_lectures/Computational_quantum_optics_lectures/notebooks/lecture1/qutip_introduction.qmd" data-notebook-title="Introduction to QuTiP" data-notebook-cellid="cell-position-eigenbasis">
<div id="cell-position-eigenbasis" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb50-2"><a href="#cb50-2"></a></span>
<span id="cb50-3"><a href="#cb50-3"></a>E, T <span class="op">=</span> x.eigenstates()</span>
<span id="cb50-4"><a href="#cb50-4"></a></span>
<span id="cb50-5"><a href="#cb50-5"></a>U <span class="op">=</span> np.zeros((N, N)).astype(np.complex128)</span>
<span id="cb50-6"><a href="#cb50-6"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(N):</span>
<span id="cb50-7"><a href="#cb50-7"></a>    U[:,i] <span class="op">=</span> T[i].full().flatten()</span>
<span id="cb50-8"><a href="#cb50-8"></a></span>
<span id="cb50-9"><a href="#cb50-9"></a>U <span class="op">=</span> qutip.Qobj(U)</span>
<span id="cb50-10"><a href="#cb50-10"></a></span>
<span id="cb50-11"><a href="#cb50-11"></a>xlist <span class="op">=</span> ( U.dag() <span class="op">*</span> x <span class="op">*</span> U ).diag()</span>
<span id="cb50-12"><a href="#cb50-12"></a>dx <span class="op">=</span> xlist[<span class="dv">1</span>] <span class="op">-</span> xlist[<span class="dv">0</span>]</span>
<span id="cb50-13"><a href="#cb50-13"></a></span>
<span id="cb50-14"><a href="#cb50-14"></a><span class="co"># Harmonic potential</span></span>
<span id="cb50-15"><a href="#cb50-15"></a>V <span class="op">=</span> w<span class="op">**</span><span class="dv">2</span> <span class="op">/</span> <span class="dv">2</span> <span class="op">*</span> xlist<span class="op">**</span><span class="dv">2</span></span>
<span id="cb50-16"><a href="#cb50-16"></a></span>
<span id="cb50-17"><a href="#cb50-17"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb50-18"><a href="#cb50-18"></a></span>
<span id="cb50-19"><a href="#cb50-19"></a>ax.plot(xlist, V, color<span class="op">=</span><span class="st">"black"</span>, ls<span class="op">=</span><span class="st">"--"</span>, lw<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb50-20"><a href="#cb50-20"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):</span>
<span id="cb50-21"><a href="#cb50-21"></a>    factor <span class="op">=</span> <span class="dv">5</span> <span class="co"># The purpose of this factor is to only make more visible the states</span></span>
<span id="cb50-22"><a href="#cb50-22"></a>    ax.plot(xlist, factor <span class="op">*</span> np.<span class="bu">abs</span>( (U.dag() <span class="op">*</span> qutip.fock(N, i)).full() )<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> i <span class="op">*</span> w <span class="op">+</span> w<span class="op">/</span><span class="dv">2</span>, lw<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb50-23"><a href="#cb50-23"></a></span>
<span id="cb50-24"><a href="#cb50-24"></a>ax.set_xlabel(<span class="vs">r"</span><span class="dv">$</span><span class="vs">x</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb50-25"><a href="#cb50-25"></a>ax.set_xlim(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>)</span>
<span id="cb50-26"><a href="#cb50-26"></a>ax.set_ylim(<span class="dv">0</span>, <span class="dv">5</span>)</span>
<span id="cb50-27"><a href="#cb50-27"></a></span>
<span id="cb50-28"><a href="#cb50-28"></a><span class="co"># Show in Quarto</span></span>
<span id="cb50-29"><a href="#cb50-29"></a>plt.savefig(<span class="st">"_tmp_fig.svg"</span>)</span>
<span id="cb50-30"><a href="#cb50-30"></a>plt.close(fig)</span>
<span id="cb50-31"><a href="#cb50-31"></a>SVG(<span class="st">"_tmp_fig.svg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="qutip_introduction_files/figure-html/-notebooks-lecture1-qutip_introduction-position-eigenbasis-output-1.svg" id="position-eigenbasis" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../lecture1/quantum_objects_numpy.html" class="pagination-link" aria-label="Representing Quantum States and Operators with NumPy">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Representing Quantum States and Operators with NumPy</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../lecture1/closed_systems.html" class="pagination-link" aria-label="Closed Quantum Systems in QuTiP: The Schrödinger equation">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Closed Quantum Systems in QuTiP: The Schrödinger equation</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>