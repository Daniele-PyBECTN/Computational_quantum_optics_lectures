<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>11&nbsp; Open Dynamics in QuTiP: The Master Equation – Numerical Methods for Quantum Optics and Open Quantum Systems</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../lecture2/jaynes_cummings.html" rel="next">
<link href="../lecture1/closed_systems.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-c1f63da3e08f13bc72dc17e92cfd001d.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-e25bb2ec88b96ab004d13ad1d1924df4.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-c1f63da3e08f13bc72dc17e92cfd001d.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-d3bfbbef162137c92838cc489ea96151.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-0f4dc18409c8cdf6ba22a617749a6af3.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../site_libs/bootstrap/bootstrap-d3bfbbef162137c92838cc489ea96151.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Numerical Methods for Quantum Optics and Open Quantum Systems</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
    <a href="../Numerical-Methods-for-Quantum-Optics-and-Open-Quantum-Systems.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../lecture2/master_equation_qutip.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Open Dynamics in QuTiP: The Master Equation</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Home Page</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lecture1/intro_heisenberg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction to quantum mechanics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lecture1/introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">About the course</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lecture1/linear_algebra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Linear Algebra with NumPy and SciPy</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lecture1/numba_and_jax.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Speeding up Python for Linear Algebra Tasks</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lecture1/ordinary_differential_equations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Ordinary Differential Equations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lecture1/phase_space_ode.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">From Hamilton’s equations to the Liouville equation in phase space</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lecture1/quantum_objects_numpy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Representing Quantum States and Operators with NumPy</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lecture1/qutip_introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introduction to QuTiP</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lecture1/closed_systems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Closed Quantum Systems in QuTiP: The Schrödinger equation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lecture2/master_equation_qutip.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Open Dynamics in QuTiP: The Master Equation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lecture2/jaynes_cummings.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">The Jaynes–Cummings model: The Prove of Field Quantization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lecture3/mollow_triplet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Resonance Fluorescence and the Mollow Triplet</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../lecture3/jaynes_cummings_spectrum.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">The Emission Spectrum of the Jaynes–Cummings Model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../bibliography.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bibliography</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/quantum-harmonic-oscillator.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">The quantum harmonic oscillator</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../appendices/wigner_function.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">From classical densities to the Wigner function</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#example-the-damped-harmonic-oscillator" id="toc-example-the-damped-harmonic-oscillator" class="nav-link active" data-scroll-target="#example-the-damped-harmonic-oscillator"><span class="header-section-number">11.1</span> Example: the damped harmonic oscillator</a>
  <ul class="collapse">
  <li><a href="#plotting-the-results" id="toc-plotting-the-results" class="nav-link" data-scroll-target="#plotting-the-results"><span class="header-section-number">11.1.1</span> Plotting the results</a></li>
  </ul></li>
  <li><a href="#time-dependent-parameters-the-case-of-logical-quantum-gates" id="toc-time-dependent-parameters-the-case-of-logical-quantum-gates" class="nav-link" data-scroll-target="#time-dependent-parameters-the-case-of-logical-quantum-gates"><span class="header-section-number">11.2</span> Time-dependent parameters: the case of logical quantum gates</a></li>
  </ul>
<div class="quarto-other-links"><h2>Other Links</h2><ul><li><a href="https://mybinder.org/v2/gh/Daniele-PyBECTN/Computational_quantum_optics_lectures/notebooks/?urlpath=lab/tree/notebooks/lecture2/master_equation_qutip.ipynb"><i class="bi bi-file-code"></i>Run notebook in Binder</a></li><li><a href="https://colab.research.google.com/github/Daniele-PyBECTN/Computational_quantum_optics_lectures/blob/notebooks/notebooks/lecture2/master_equation_qutip.ipynb"><i class="bi bi-google"></i>Run notebook in Google Colab</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Open Dynamics in QuTiP: The Master Equation</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In <a href="../lecture1/closed_systems.html" class="quarto-xref"><span>Chapter 10</span></a>, we discussed the evolution of closed quantum systems, where the dynamics is governed by the Schrödinger equation. The evolution of the state vector <span class="math inline">\(\ket{\psi(t)}\)</span> is given by:</p>
<p><span class="math display">\[
\frac{d \ket{\psi(t)}}{dt} = -\frac{i}{\hbar} \hat{H} \ket{\psi(t)}
\]</span></p>
<p>where <span class="math inline">\(\hat{H}\)</span> is the Hamiltonian operator of the system. The solution to this equation leads to unitary evolution. In contrast to the closed case, open quantum systems interact with their environment, leading to non-unitary evolution described by the Master equation:</p>
<p><span class="math display">\[
\frac{d \hat{\rho}}{dt} = -\frac{i}{\hbar}[\hat{H}, \hat{\rho}] + \sum_k \left( \hat{L}_k \hat{\rho} \hat{L}_k^\dagger - \frac{1}{2} \{\hat{L}_k^\dagger \hat{L}_k, \hat{\rho}\} \right)
\]</span></p>
<p>Here, <span class="math inline">\(\hat{\rho}\)</span> represents the density matrix of the system, <span class="math inline">\(\hat{L}_k\)</span> are the Lindblad operators representing different dissipation processes. and <span class="math inline">\(\{\hat{A}, \hat{B} \} = \hat{A} \hat{B} + \hat{B} \hat{A}\)</span> is the anti-commutator between the operators <span class="math inline">\(\hat{A}\)</span> and <span class="math inline">\(\hat{B}\)</span>.</p>
<section id="example-the-damped-harmonic-oscillator" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="example-the-damped-harmonic-oscillator"><span class="header-section-number">11.1</span> Example: the damped harmonic oscillator</h2>
<p>We can use the Master equation to study the dynamics of a damped harmonic oscillator. The Hamiltonian for a harmonic oscillator is given by:</p>
<p><span class="math display">\[
\hat{H} = \omega_0 \hat{a}^\dagger \hat{a}
\]</span></p>
<p>where <span class="math inline">\(\hat{a}\)</span> and <span class="math inline">\(\hat{a}^\dagger\)</span> are the annihilation and creation operators, respectively, and <span class="math inline">\(\omega_0\)</span> is the angular frequency of the oscillator.</p>
<div class="quarto-embed-nb-cell" data-notebook="/home/runner/work/Computational_quantum_optics_lectures/Computational_quantum_optics_lectures/notebooks/lecture2/master_equation_qutip.qmd" data-notebook-title="Open Dynamics in QuTiP: The Master Equation" data-notebook-cellid="cell-hamiltonian">
<div id="hamiltonian" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="im">from</span> qutip <span class="im">import</span> <span class="op">*</span></span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co"># Parameters</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>N <span class="op">=</span> <span class="dv">30</span>  <span class="co"># Number of Fock states</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>omega_0 <span class="op">=</span> <span class="fl">1.0</span>  <span class="co"># Angular frequency of the oscillator</span></span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a>a <span class="op">=</span> destroy(N)  <span class="co"># Annihilation operator</span></span>
<span id="cb1-9"><a href="#cb1-9"></a></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co"># Hamiltonian</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>H <span class="op">=</span> omega_0 <span class="op">*</span> a.dag() <span class="op">*</span> a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>To model the damping, we can introduce a Lindblad operator that represents the interaction with the environment. In the case of the interaction with a zero-temperature bath, the Lindblad operator can be defined as:</p>
<p><span class="math display">\[
\hat{L} = \sqrt{\gamma} \hat{a}
\]</span></p>
<p>where <span class="math inline">\(\gamma\)</span> is the damping rate. Let’s now initialize the system in a coherent state and evolve it using the Master equation. We will also visualize the evolution of the position and energy expectation values over time.</p>
<div class="quarto-embed-nb-cell" data-notebook="/home/runner/work/Computational_quantum_optics_lectures/Computational_quantum_optics_lectures/notebooks/lecture2/master_equation_qutip.qmd" data-notebook-title="Open Dynamics in QuTiP: The Master Equation" data-notebook-cellid="cell-damped-harmonic-oscillator">
<div id="cell-damped-harmonic-oscillator" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Damping rate</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>gamma <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co"># Lindblad operator</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>L <span class="op">=</span> np.sqrt(gamma) <span class="op">*</span> a</span>
<span id="cb2-6"><a href="#cb2-6"></a></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co"># Initial state: coherent state</span></span>
<span id="cb2-8"><a href="#cb2-8"></a>alpha <span class="op">=</span> <span class="fl">3.0</span></span>
<span id="cb2-9"><a href="#cb2-9"></a>psi_0 <span class="op">=</span> coherent(N, alpha)</span>
<span id="cb2-10"><a href="#cb2-10"></a></span>
<span id="cb2-11"><a href="#cb2-11"></a>tlist <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">500</span>)</span>
<span id="cb2-12"><a href="#cb2-12"></a></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="co"># Solve the Master equation</span></span>
<span id="cb2-14"><a href="#cb2-14"></a>result <span class="op">=</span> mesolve(H, psi_0, tlist, [L], e_ops<span class="op">=</span>[a.dag() <span class="op">*</span> a, a <span class="op">+</span> a.dag()])</span>
<span id="cb2-15"><a href="#cb2-15"></a>result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="damped-harmonic-oscillator" class="cell-output cell-output-display">
<pre><code>&lt;Result
  Solver: mesolve
  Solver stats:
    method: 'scipy zvode adams'
    init time: 0.0001773834228515625
    preparation time: 0.0002970695495605469
    run time: 0.26758480072021484
    solver: 'Master Equation Evolution'
    num_collapse: 1
  Time interval: [0.0, 50.0] (500 steps)
  Number of e_ops: 2
  State not saved.
&gt;</code></pre>
</div>
</div>
</div>
<section id="plotting-the-results" class="level3" data-number="11.1.1">
<h3 data-number="11.1.1" class="anchored" data-anchor-id="plotting-the-results"><span class="header-section-number">11.1.1</span> Plotting the results</h3>
<div class="quarto-embed-nb-cell" data-notebook="/home/runner/work/Computational_quantum_optics_lectures/Computational_quantum_optics_lectures/notebooks/lecture2/master_equation_qutip.qmd" data-notebook-title="Open Dynamics in QuTiP: The Master Equation" data-notebook-cellid="cell-damped-harmonic-oscillator-plot">
<div id="cell-damped-harmonic-oscillator-plot" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co"># Plot the expectation values</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb4-5"><a href="#cb4-5"></a></span>
<span id="cb4-6"><a href="#cb4-6"></a>ax.plot(tlist, result.expect[<span class="dv">0</span>], label<span class="op">=</span><span class="vs">r"Energy </span><span class="dv">$</span><span class="er">\</span><span class="vs">langle </span><span class="er">\</span><span class="vs">hat{H} </span><span class="ch">\r</span><span class="vs">angle</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb4-7"><a href="#cb4-7"></a>ax.plot(tlist, result.expect[<span class="dv">1</span>].real, label<span class="op">=</span><span class="vs">r"Position </span><span class="dv">$</span><span class="er">\</span><span class="vs">langle </span><span class="er">\</span><span class="vs">hat{x} </span><span class="ch">\r</span><span class="vs">angle</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb4-8"><a href="#cb4-8"></a>ax.set_xlabel(<span class="vs">r"Time </span><span class="dv">$</span><span class="vs">t</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb4-9"><a href="#cb4-9"></a>ax.set_ylabel(<span class="st">"Expectation values"</span>)</span>
<span id="cb4-10"><a href="#cb4-10"></a>ax.legend()</span>
<span id="cb4-11"><a href="#cb4-11"></a>ax.set_title(<span class="st">"Damped Harmonic Oscillator Dynamics"</span>)</span>
<span id="cb4-12"><a href="#cb4-12"></a></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="co"># Show in Quarto</span></span>
<span id="cb4-14"><a href="#cb4-14"></a>plt.savefig(<span class="st">"_tmp_fig.svg"</span>)</span>
<span id="cb4-15"><a href="#cb4-15"></a>plt.close()</span>
<span id="cb4-16"><a href="#cb4-16"></a>SVG(<span class="st">"_tmp_fig.svg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="master_equation_qutip_files/figure-html/-notebooks-lecture2-master_equation_qutip-damped-harmonic-oscillator-plot-output-1.svg" id="damped-harmonic-oscillator-plot" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="time-dependent-parameters-the-case-of-logical-quantum-gates" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="time-dependent-parameters-the-case-of-logical-quantum-gates"><span class="header-section-number">11.2</span> Time-dependent parameters: the case of logical quantum gates</h2>
<p>In classical computing, logical gates such as AND, OR, and NOT process bits (0 or 1) to perform basic operations. For example:</p>
<ul>
<li>AND outputs 1 only if both inputs are 1.</li>
<li>OR outputs 1 if at least one input is 1.</li>
<li>NOT inverts its input bit.</li>
</ul>
<p>These gates form the building blocks of all classical algorithms and digital circuits.</p>
<p>Quantum computing generalizes this idea by using qubits, which can exist in superpositions of 0 and 1. Quantum gates act on these superposed states via time-dependent Hamiltonians, enabling phenomena like entanglement and interference. This richer behaviour unlocks powerful algorithms (e.g., Shor’s factoring, Grover’s search) that have no efficient classical equivalent.</p>
<p>As an example, we consider a combination of gates that generates a bell state</p>
<p><span id="eq-bell-state"><span class="math display">\[
| \Phi^+ \rangle = \frac{1}{\sqrt{2}} (| 00 \rangle + | 11 \rangle).
\tag{11.1}\]</span></span></p>
<p>To achieve this, we can use a sequence of quantum gates:</p>
<ol type="1">
<li><strong>Hadamard gate</strong>: Applies a Hadamard gate to the first qubit, transforming <span class="math inline">\(| 0 \rangle\)</span> into <span class="math inline">\(\frac{1}{\sqrt{2}} (| 0 \rangle + | 1 \rangle)\)</span>.</li>
<li><strong>CNOT gate</strong>: Applies a controlled-NOT gate, where the first qubit controls the second. This flips the second qubit if the first is in state <span class="math inline">\(| 1 \rangle\)</span>.</li>
</ol>
<div class="quarto-embed-nb-cell" data-notebook="/home/runner/work/Computational_quantum_optics_lectures/Computational_quantum_optics_lectures/notebooks/lecture2/master_equation_qutip.qmd" data-notebook-title="Open Dynamics in QuTiP: The Master Equation" data-notebook-cellid="cell-bell-state-circuit">
<div id="cell-bell-state-circuit" class="cell" data-execution_count="5">
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="master_equation_qutip_files/figure-html/-notebooks-lecture2-master_equation_qutip-bell-state-circuit-output-1.svg" id="bell-state-circuit" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<p>Each gate can be represented by a time-dependent Hamiltonian. For example, the Hadamard gate can be implemented using a Hamiltonian</p>
<p><span class="math display">\[
\hat{H}_\mathrm{H}^{(1)} (t_0, t) = \Theta (t - t_0) \Theta ( t_0 + \pi / 2 - t) \frac{1}{\sqrt{2}} \left( \hat{\sigma}_x^{(1)} - \hat{\sigma}_z^{(1)} \right)
\]</span></p>
<p>where <span class="math inline">\(\Theta(t)\)</span> is the Heaviside step function, and <span class="math inline">\(\hat{\sigma}_x^{(1)}\)</span> and <span class="math inline">\(\hat{\sigma}_z^{(1)}\)</span> are the Pauli operators acting on the first qubit. The Heaviside function ensures that the Hamiltonian is non-zero only during the time interval <span class="math inline">\([t_0, t_0 + \pi / 2]\)</span>, where <span class="math inline">\(t_0\)</span> is the time at which the gate is applied.</p>
<p>The CNOT gate can be implemented using a Hamiltonian that couples the two qubits</p>
<p><span class="math display">\[
\hat{H}_\mathrm{CNOT} (t_0, t) = \Theta (t - t_0) \Theta ( t_0 + \pi / 2 - t) \ \left(\hat{\mathbb{1}} + \hat{\sigma}_z^{(1)} \right) \otimes \left( \hat{\mathbb{1}} - \hat{\sigma}_x^{(2)} \right)
\]</span></p>
<p>where <span class="math inline">\(\hat{\sigma}_x^{(2)}\)</span> acts on the second qubit, and <span class="math inline">\(\hat{\mathbb{1}}\)</span> is the identity operator. The Heaviside function again ensures that the Hamiltonian is non-zero only during the time interval <span class="math inline">\([t_0, t_0 + \pi / 2]\)</span>.</p>
<p>In absence of losses, the output state after applying these gates is exactly the Bell state <span class="math inline">\(|\Phi^+\rangle\)</span> defined in <a href="#eq-bell-state" class="quarto-xref">Equation&nbsp;<span>11.1</span></a>. However, in a realistic scenario, we need to account for the effects of decoherence and dissipation, which can be modeled using the Master equation. This poses a challenge for quantum computing, as the coherence of the qubits must be maintained during the gate operations to ensure the correct output state.</p>
<p>To simulate the effects of decoherence, we consider the case where the qubits are in interaction with a finite-temperature environment, which can lead to energy dissipation and dephasing. In this case, the Master equation can be used to describe the dynamics of the system. We can introduce a Lindblad operator that represents the interaction with the environment. For example, we can use a Lindblad operator that describes the decay of the qubits:</p>
<p><span class="math display">\[\begin{align*}
\hat{L}_1 &amp;= \sqrt{\gamma (n_\mathrm{th} + 1)} \hat{\sigma}_-^{(1)}, \quad \hat{L}_2 = \sqrt{\gamma (n_\mathrm{th} + 1)} \hat{\sigma}_-^{(2)} \\
\hat{L}_3 &amp;= \sqrt{\gamma n_\mathrm{th}} \hat{\sigma}_+^{(1)}, \quad \hat{L}_4 = \sqrt{\gamma n_\mathrm{th}} \hat{\sigma}_+^{(2)}
\end{align*}\]</span></p>
<p>where <span class="math inline">\(\hat{\sigma}_+^{(i)}\)</span> and <span class="math inline">\(\hat{\sigma}_-^{(i)}\)</span> are the raising and lowering operators for the <span class="math inline">\(i\)</span>-th qubit, respectively, <span class="math inline">\(n_\mathrm{th}\)</span> is the average number of thermal excitations in the environment, and <span class="math inline">\(\gamma\)</span> is the decay rate. The Lindblad operators describe both energy dissipation (via <span class="math inline">\(\hat{\sigma}_-\)</span>) and thermal excitation (via <span class="math inline">\(\hat{\sigma}_+\)</span>) of the qubits.</p>
<p>We can use the ability of QuTiP to define time-dependent Hamiltonians to simulate the evolution of the system under the influence of these gates and the Lindblad operators.</p>
<div class="quarto-embed-nb-cell" data-notebook="/home/runner/work/Computational_quantum_optics_lectures/Computational_quantum_optics_lectures/notebooks/lecture2/master_equation_qutip.qmd" data-notebook-title="Open Dynamics in QuTiP: The Master Equation" data-notebook-cellid="cell-master-equation-gates">
<div id="cell-master-equation-gates" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">def</span> heaviside(t, t0):</span>
<span id="cb5-2"><a href="#cb5-2"></a>    <span class="cf">return</span> t <span class="op">&gt;=</span> t0</span>
<span id="cb5-3"><a href="#cb5-3"></a></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="kw">def</span> hadamard_coeff(t):</span>
<span id="cb5-5"><a href="#cb5-5"></a>    t0 <span class="op">=</span> <span class="dv">0</span>  <span class="co"># Start time of the Hadamard gate</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>    <span class="cf">return</span> heaviside(t, t0) <span class="op">*</span> heaviside(t0 <span class="op">+</span> np.pi <span class="op">/</span> <span class="dv">2</span>, t)</span>
<span id="cb5-7"><a href="#cb5-7"></a></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="kw">def</span> cnot_coeff(t):</span>
<span id="cb5-9"><a href="#cb5-9"></a>    t0 <span class="op">=</span> np.pi <span class="op">/</span> <span class="dv">2</span>  <span class="co"># Start time of the CNOT gate</span></span>
<span id="cb5-10"><a href="#cb5-10"></a>    <span class="cf">return</span> heaviside(t, t0) <span class="op">*</span> heaviside(t0 <span class="op">+</span> np.pi <span class="op">/</span> <span class="dv">2</span>, t)</span>
<span id="cb5-11"><a href="#cb5-11"></a></span>
<span id="cb5-12"><a href="#cb5-12"></a>sm1 <span class="op">=</span> tensor(sigmam(), qeye(<span class="dv">2</span>))  <span class="co"># Lowering operator for qubit 1</span></span>
<span id="cb5-13"><a href="#cb5-13"></a>sm2 <span class="op">=</span> tensor(qeye(<span class="dv">2</span>), sigmam())  <span class="co"># Lowering operator for qubit 2</span></span>
<span id="cb5-14"><a href="#cb5-14"></a>sx1 <span class="op">=</span> tensor(sigmax(), qeye(<span class="dv">2</span>))  <span class="co"># Pauli X for qubit 1</span></span>
<span id="cb5-15"><a href="#cb5-15"></a>sz1 <span class="op">=</span> tensor(sigmaz(), qeye(<span class="dv">2</span>))  <span class="co"># Pauli Z for qubit 1</span></span>
<span id="cb5-16"><a href="#cb5-16"></a>sx2 <span class="op">=</span> tensor(qeye(<span class="dv">2</span>), sigmax())  <span class="co"># Pauli X for qubit 2</span></span>
<span id="cb5-17"><a href="#cb5-17"></a></span>
<span id="cb5-18"><a href="#cb5-18"></a><span class="co"># Parameters</span></span>
<span id="cb5-19"><a href="#cb5-19"></a>gamma <span class="op">=</span> <span class="fl">0.1</span>  <span class="co"># Decay rate</span></span>
<span id="cb5-20"><a href="#cb5-20"></a>T <span class="op">=</span> <span class="fl">0.1</span>  <span class="co"># Temperature (arbitrary units)</span></span>
<span id="cb5-21"><a href="#cb5-21"></a>n_th <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (np.exp(<span class="dv">1</span> <span class="op">/</span> T) <span class="op">-</span> <span class="dv">1</span>)  <span class="co"># Average number of thermal excitations</span></span>
<span id="cb5-22"><a href="#cb5-22"></a></span>
<span id="cb5-23"><a href="#cb5-23"></a><span class="co"># Hadamard gate Hamiltonian</span></span>
<span id="cb5-24"><a href="#cb5-24"></a>H_hadamard <span class="op">=</span> (sx1 <span class="op">-</span> sz1) <span class="op">/</span> np.sqrt(<span class="dv">2</span>)</span>
<span id="cb5-25"><a href="#cb5-25"></a></span>
<span id="cb5-26"><a href="#cb5-26"></a><span class="co"># CNOT gate Hamiltonian</span></span>
<span id="cb5-27"><a href="#cb5-27"></a>H_cnot <span class="op">=</span> (<span class="dv">1</span> <span class="op">+</span> sz1) <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> sx2) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb5-28"><a href="#cb5-28"></a></span>
<span id="cb5-29"><a href="#cb5-29"></a><span class="co"># Time-dependent Hamiltonian</span></span>
<span id="cb5-30"><a href="#cb5-30"></a>H <span class="op">=</span> [[H_hadamard, hadamard_coeff],</span>
<span id="cb5-31"><a href="#cb5-31"></a>     [H_cnot, cnot_coeff]]</span>
<span id="cb5-32"><a href="#cb5-32"></a></span>
<span id="cb5-33"><a href="#cb5-33"></a><span class="co"># Lindblad dissipation operators</span></span>
<span id="cb5-34"><a href="#cb5-34"></a>L1 <span class="op">=</span> np.sqrt(gamma <span class="op">*</span> (n_th <span class="op">+</span> <span class="dv">1</span>)) <span class="op">*</span> sm1</span>
<span id="cb5-35"><a href="#cb5-35"></a>L2 <span class="op">=</span> np.sqrt(gamma <span class="op">*</span> (n_th <span class="op">+</span> <span class="dv">1</span>)) <span class="op">*</span> sm2</span>
<span id="cb5-36"><a href="#cb5-36"></a>L3 <span class="op">=</span> np.sqrt(gamma <span class="op">*</span> n_th) <span class="op">*</span> sm1.dag()</span>
<span id="cb5-37"><a href="#cb5-37"></a>L4 <span class="op">=</span> np.sqrt(gamma <span class="op">*</span> n_th) <span class="op">*</span> sm2.dag()</span>
<span id="cb5-38"><a href="#cb5-38"></a></span>
<span id="cb5-39"><a href="#cb5-39"></a>c_ops <span class="op">=</span> [L1, L2, L3, L4]</span>
<span id="cb5-40"><a href="#cb5-40"></a></span>
<span id="cb5-41"><a href="#cb5-41"></a><span class="co"># Initial state: |00&gt;</span></span>
<span id="cb5-42"><a href="#cb5-42"></a>psi_0 <span class="op">=</span> tensor(basis(<span class="dv">2</span>, <span class="dv">1</span>), basis(<span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb5-43"><a href="#cb5-43"></a></span>
<span id="cb5-44"><a href="#cb5-44"></a><span class="co"># Time list</span></span>
<span id="cb5-45"><a href="#cb5-45"></a>tlist <span class="op">=</span> np.linspace(<span class="dv">0</span>, np.pi, <span class="dv">500</span>)</span>
<span id="cb5-46"><a href="#cb5-46"></a></span>
<span id="cb5-47"><a href="#cb5-47"></a><span class="co"># Solve the Master equation</span></span>
<span id="cb5-48"><a href="#cb5-48"></a>result <span class="op">=</span> mesolve(H, psi_0, tlist, c_ops)</span>
<span id="cb5-49"><a href="#cb5-49"></a>result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="master-equation-gates" class="cell-output cell-output-display">
<pre><code>&lt;Result
  Solver: mesolve
  Solver stats:
    method: 'scipy zvode adams'
    init time: 7.176399230957031e-05
    preparation time: 0.0002262592315673828
    run time: 0.028150558471679688
    solver: 'Master Equation Evolution'
    num_collapse: 4
  Time interval: [0.0, 3.141592653589793] (500 steps)
  Number of e_ops: 0
  States saved.
&gt;</code></pre>
</div>
</div>
</div>
<p>We now plot the following quantities as a function of time:</p>
<ul>
<li>The probability of finding the first qubit in state <span class="math inline">\(| 1 \rangle\)</span>.</li>
<li>The probability of finding the second qubit in state <span class="math inline">\(| 1 \rangle\)</span>.</li>
<li>The fidelity with the target Bell state <span class="math inline">\(|\Phi^+\rangle\)</span>.</li>
</ul>
<div class="quarto-embed-nb-cell" data-notebook="/home/runner/work/Computational_quantum_optics_lectures/Computational_quantum_optics_lectures/notebooks/lecture2/master_equation_qutip.qmd" data-notebook-title="Open Dynamics in QuTiP: The Master Equation" data-notebook-cellid="cell-master-equation-gates-plot">
<div id="cell-master-equation-gates-plot" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Bell state</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>bell_state <span class="op">=</span> (tensor(basis(<span class="dv">2</span>, <span class="dv">0</span>), basis(<span class="dv">2</span>, <span class="dv">0</span>)) <span class="op">+</span> tensor(basis(<span class="dv">2</span>, <span class="dv">1</span>), basis(<span class="dv">2</span>, <span class="dv">1</span>))).unit()</span>
<span id="cb7-3"><a href="#cb7-3"></a></span>
<span id="cb7-4"><a href="#cb7-4"></a>P0_1 <span class="op">=</span> expect(sm1.dag() <span class="op">*</span> sm1, result.states)</span>
<span id="cb7-5"><a href="#cb7-5"></a>P0_2 <span class="op">=</span> expect(sm2.dag() <span class="op">*</span> sm2, result.states)</span>
<span id="cb7-6"><a href="#cb7-6"></a>fid <span class="op">=</span> [fidelity(bell_state, s) <span class="cf">for</span> s <span class="kw">in</span> result.states]</span>
<span id="cb7-7"><a href="#cb7-7"></a></span>
<span id="cb7-8"><a href="#cb7-8"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb7-9"><a href="#cb7-9"></a></span>
<span id="cb7-10"><a href="#cb7-10"></a>ax.plot(tlist, P0_1, label<span class="op">=</span><span class="vs">r"</span><span class="dv">$</span><span class="vs">P_1</span><span class="dv">^</span><span class="vs">{</span><span class="kw">(</span><span class="vs">1</span><span class="kw">)</span><span class="vs">}</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb7-11"><a href="#cb7-11"></a>ax.plot(tlist, P0_2, label<span class="op">=</span><span class="vs">r"</span><span class="dv">$</span><span class="vs">P_1</span><span class="dv">^</span><span class="vs">{</span><span class="kw">(</span><span class="vs">2</span><span class="kw">)</span><span class="vs">}</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb7-12"><a href="#cb7-12"></a>ax.plot(tlist, fid, label<span class="op">=</span><span class="vs">r"Fidelity with </span><span class="dv">$</span><span class="cf">|</span><span class="er">\</span><span class="vs">Phi</span><span class="dv">^</span><span class="op">+</span><span class="ch">\r</span><span class="vs">angle</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb7-13"><a href="#cb7-13"></a>ax.set_xlabel(<span class="vs">r"Time </span><span class="dv">$</span><span class="vs">t</span><span class="dv">$</span><span class="vs">"</span>)</span>
<span id="cb7-14"><a href="#cb7-14"></a>ax.set_ylabel(<span class="st">"Probability / Fidelity"</span>)</span>
<span id="cb7-15"><a href="#cb7-15"></a>ax.set_ylim(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb7-16"><a href="#cb7-16"></a>ax.legend()</span>
<span id="cb7-17"><a href="#cb7-17"></a></span>
<span id="cb7-18"><a href="#cb7-18"></a><span class="co"># Show in Quarto</span></span>
<span id="cb7-19"><a href="#cb7-19"></a>plt.savefig(<span class="st">"_tmp_fig.svg"</span>)</span>
<span id="cb7-20"><a href="#cb7-20"></a>plt.close()</span>
<span id="cb7-21"><a href="#cb7-21"></a>SVG(<span class="st">"_tmp_fig.svg"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="master_equation_qutip_files/figure-html/-notebooks-lecture2-master_equation_qutip-master-equation-gates-plot-output-1.svg" id="master-equation-gates-plot" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../lecture1/closed_systems.html" class="pagination-link" aria-label="Closed Quantum Systems in QuTiP: The Schrödinger equation">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Closed Quantum Systems in QuTiP: The Schrödinger equation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../lecture2/jaynes_cummings.html" class="pagination-link" aria-label="The Jaynes–Cummings model: The Prove of Field Quantization">
        <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">The Jaynes–Cummings model: The Prove of Field Quantization</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>